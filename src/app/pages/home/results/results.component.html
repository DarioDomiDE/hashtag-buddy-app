<StackLayout tkMainContent>
    <GridLayout [class.dialogOpen]="dialogOpen">
        <GridLayout rows="70,*" class="page">
            <GridLayout id="header" [class.gradient]="currentScrollingY >= parallaxHeight" row="0" columns="20,*,20">
                <StackLayout col="0" (tap)="openMenu()" verticalAlignment="middle">
                    <Image [src]="parallaxHeight > currentScrollingY ? '~/app/assets/images/icons/menu_bar_black.png' : '~/app/assets/images/icons/menu_bar_white.png'"></Image>
                </StackLayout>
                <GridLayout col="1" horizontalAlignment="center" verticalAlignment="middle">
                    <Label [text]="'results_headline' | L"  class="text-center font-medium-l" class="title"></Label>
                </GridLayout>
            </GridLayout>
            <GridLayout row="1" rows="*,50" tkMainContent>
                <GridLayout row="0">
                    <ScrollView #scrollView (scroll)="onScroll($event, scrollView, topView)" (tap)="dismissSoftKeybaord()">
                        <StackLayout>
                            <GridLayout id="preview-image" [height]="parallaxHeight" #topView>
                                <Image [src]="photo.image" stretch="aspectFill"></Image>
                            </GridLayout>
                            <StackLayout id="user-selection" class="p-l-10 p-r-10 p-b-20 p-t-10">
                                <ProgressBar page="results" width="80%" forceFreeMode="true" *ngIf="!photo.proMode"></ProgressBar>
                                <Label class="m-t-10 m-b-5">
                                    <FormattedString>
                                        <Span class="font-demi-bold" text="{{ 'results_category_user_hashtags' | L }}"></Span>
                                        <Span text="  ({{highlightStatus.length}} / 30)" fontSize="12"></Span>
                                    </FormattedString>
                                </Label>
                                <WrapLayout class="m-t-5">
                                    <ns-hashtag *ngFor="let title of highlightStatus" (onClick)="deselectHashtag(title)" [name]="'#' + title + '   &times;'" [isActive]="true"></ns-hashtag>
                                </WrapLayout>  
                                <Label class="m-r-5" text="{{ 'results_no_hashtags_selected' | L }}" *ngIf="highlightStatus.length == 0"></Label>
                                <ns-insert-hashtags-form (hashtagAdded)="addHashtag($event)" class="m-l-5 m-r-10"></ns-insert-hashtags-form>
                            </StackLayout>

                            <StackLayout orientation="vertical" class="list-group-item" *ngFor="let category of categories">
                                <GridLayout columns="*,60" class="hash-title m-l-10 m-r-20" *ngIf="category.tags.length !== 0">
                                    <Label [text]="category.title | L" class="font-demi-bold" col="0"></Label>
                                    <Button col="1" [text]="'results_select_all' | L" class="btn btn-rounded-lg btn-outline border-color-normal color-normal btn-selectall" (tap)="selectAll(category)" *ngIf="!areAllHashtagSelected(category)"></Button>
                                    <Button col="1" [text]="'results_deselect_all' | L" class="btn btn-rounded-lg btn-outline border-color-normal color-normal btn-selectall" (tap)="deselectAll(category)" *ngIf="areAllHashtagSelected(category)"></Button>
                                </GridLayout>
                                <Label text="{{ 'results_recommented_amount' | L }} {{ getRecommendedAmount(category.title) }}" class="font-reg-xs m-l-10 m-r-5" *ngIf="getRecommendedAmount(category.title) !== 0 && category.tags.length !== 0"></Label>
                                <WrapLayout class="m-t-5 m-l-5 m-b-20 tag-title" *ngIf="category.tags.length !== 0">
                                    <ns-hashtag *ngFor="let tag of category.tags" (onClick)="toggleHashtag(tag.title)" (onClickCensored)="clickedCensoredHashtag()" [name]="'#' + tag.title" [isActive]="isHashtagSelected(tag.title)" [censored]="tag.isCensored"></ns-hashtag>
                                </WrapLayout>
                            </StackLayout>
                            
                        </StackLayout>
                    </ScrollView>
                    <StackLayout class="top-shadow" isUserInteractionEnabled="false" *ngIf="currentScrollingY >= parallaxHeight - 3"></StackLayout>
                    <StackLayout class="bottom-shadow" isUserInteractionEnabled="false"></StackLayout>
                </GridLayout>
                <GridLayout row="1" columns="*" class="footer">
                    <StackLayout col="0" horizontalAliginment="center" (tap)="copySelected()">
                        <Label text="&#xf0ea;" class="fas text-center" fontSize="20"></Label>
                        <Label text="{{ 'results_copy_selected' | L }}" class="text-center font-medium-xs"></Label>
                    </StackLayout>
                    <!-- <StackLayout col="1" horizontalAliginment="center" (tap)="transferToInstagram()" class="open-instagram">
                        <Label text="&#xf16d;" class="fab text-center" fontSize="20"></Label>
                        <Label text="{{ 'results_copy_to_instagram' | L }}" class="text-center font-medium-xs"></Label>
                    </StackLayout> -->
                </GridLayout>
            </GridLayout>                         
        </GridLayout>
        <AbsoluteLayout class="dialog-wrapper" *ngIf="dialogOpen" horizontalAlignment="center">
            <StackLayout class="dialog">            
                <StackLayout class="dialog2">
                    <Image src="~/app/assets/images/copied.png" width="60" height="50"></Image>
                    <Label [text]="'copy_successful' | L" class="m-t-20 text-center"></Label>
                </StackLayout>
            </StackLayout>
        </AbsoluteLayout>
    </GridLayout>              
</StackLayout>